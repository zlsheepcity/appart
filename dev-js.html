<!doctype html><!-- appart :: 8102 :: 2019.11.7 -->
<html lang="ru">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- ========================================= HEAD CONTENT -->


    <title>js tests</title>
    <meta name="description" content="Frontend code templates" />
    <meta name="author"      content="zl 2019, zl.sheepcity@gmail.com" />


    <!-- FAVICON -->
    <!-- 2019.1, best favicon service: https://realfavicongenerator.net/ -->
    <meta name="theme-color" content="#314863">
    <meta name="msapplication-TileColor" content="#314863">
    <meta name="msapplication-TileImage" content="app/favicons/144x144.png">
    <link href="app/favicons/180x180.png" sizes="180x180" rel="apple-touch-icon">
    <link href="app/favicons/192x192.png" sizes="192x192" rel="icon" type="image/png">


    <!-- ========================================= BOOT -->


    <!-- ༼°▽°༽ style boot -->
    <style>
        body    { width: 100%; height: auto; overflow: hidden; }
        img,svg { max-width: 100%; }
    </style>

    <!-- ༼°▽°༽ prefetch boot -->
    <link rel="preconnect"   href="//fonts.gstatic.com">
    <link rel="preconnect"   href="//images.unsplash.com">

    <!-- ༼°▽°༽ app boot -->
    <script>
        function AppBoot() {

         // The Noble Blastula
            let app = this
            app.has = { memory: [], status: false }
            app.has.queens = [ 'onload', 'mutate' ]

         // Define responsibility
         /*
            King has arrived ===> let app = new AppBoot()
            Take the Queen =====> app.attach('queen_name')(function)
            Keep in memory =====> app.queen_name(function_parameters)
            Execute later ======> app.onload(function)
            2019.11.7 */
            const AppBootStart = (dna) => {
                app.attach     =  TakeTheQueen
                dna.map( queen => app.attach(queen) ) }
            const TakeTheQueen = (queen) => {
                    app[queen] =  ExecuteLater(queen)
                    return (f) => ExecuteLater('update')({name:queen,f}) }
            const KeepInMemory = (dna) => app.has.memory.push(dna)
            const ExecuteLater =
                 (responsible) =>
                         (dna) => KeepInMemory({dna,for:responsible})

         // Apply responsibility
            AppBootStart(app.has.queens)

         // The Noble Provocator
            const proteinProvoker = function ImitateCriticalTasks () {
              let tpp = new this.__proto__.constructor()
              let must_have_a_memory = tpp.has.memory.push('something')
              let must_accept_queens = like_this_one => true
              tpp.attach('queen_id')(must_accept_queens)
              tpp.queen_id('try this')
            }
            app.ForceErrorsIfShouldBe =  proteinProvoker
        }

     // Run Immediately
        let app = new AppBoot()
        app.ForceErrorsIfShouldBe()
    </script>


    <!-- ========================================= DESIGN -->


    <link
        href="app/styles/appart-dev.css?v2019.11.7"
        rel="stylesheet" type="text/css">
    <link
        href="https://fonts.googleapis.com/css?family=Vollkorn:400,400i,700&subset=cyrillic"
        rel="stylesheet">


    <!-- ========================================= APP -->


    <script defer src="app/script/app-core.js"></script>

    <!-- interface -->
    <script defer src="app/script/components/css-class-mutator.js"></script>
    <script defer src="app/script/components/image-zzzoom.js"></script>
    <script defer src="app/script/components/image-lazy-loader.js"></script>
    <script defer src="app/script/components/scroll-to-var.js"></script>
    <script>app.attach('wayway')</script>
    <script defer src="app/script/components/headroom.js"></script>


    <!-- ========================================= APP CUSTOM -->


    <!-- dev functions -->
    <script defer src="app/script/components/survival-test.js"></script>
    <script defer src="app/script/components/autofill-paragraphs.js"></script>

    <style>
        .screen {
            display: block;
            min-height: 100vh;
            padding: 3rem;
        }
    </style>

    <!-- ========================================== ʕ⊙ᴥ⊙ʔ = -->
    <!-- ========================================= END HEAD -->
</head>
<body class="colors--primary native-sans">

    <!-- ----------------------------------------- Insect Observer -->

    <article>
        <style>

        </style>
        <section id="insect1" class="screen use-colors colors--secondary"
                 style="height:120vh;">
            secondary
        </section>
        <section id="insect2" class="screen use-colors colors--ivory insect2c">
            ivory-a
        </section>
        <section id="insect3" class="screen use-colors colors--ivory insect2c">
            ivory-b
        </section>
        <script>
            function insect00( dna = {} ) {
                let polymerase = {
                    el:  q => document.querySelector(q) || false,
                    els: q => [...document.querySelectorAll(q)],
                    add: f => ff=>{ rna.elTarget.classList.add(rna.marker) },
                    rem: f => ff=>{ rna.elTarget.classList.remove(rna.marker) }
                }
                let rna = Object.assign({
                    margin:     '0%',
                    marker:     'is-active',
                    once:        false,
                    fy:          polymerase.add(),
                    fn:          polymerase.rem(),
                    elTrigger:   polymerase.el(dna.trigger),
                    elTarget:    polymerase.el(dna.target)
                    }, dna)
                rna.Invalid = function() {
                    if(!'IntersectionObserver' in window) return true
                    if(!this.elTrigger)                   return true
                    if(!this.elTarget)                    return true
                    if(typeof(this.fy)!=='function')      return true
                    if(typeof(this.fn)!=='function')      return true
                    return false }
                if (rna.Invalid()) return false


                const hasInsect = e => {
                    if (API.state) return false
                    API.setState(true)
                    API.runFYes(e)
                    API.stopOnce()
                }
                const notInsect = e => {
                    if (API.itwas && !API.state) return false
                    API.setState(false)
                    API.runFNot(e)
                }
                const runInsect = f => Entomolog.observe(rna.elTrigger)
                const offInsect = f => Entomolog.unobserve(rna.elTrigger)
                const Delegator = entries => entries.forEach(Insectask)
                const Insectask = o => o.isIntersecting ? hasInsect(o) : notInsect(o)
                const DeOptions = {rootMargin:rna.margin}
                const Entomolog = new IntersectionObserver(Delegator, DeOptions)


                const setState  = x => { API.state=!!x; if (API.state) API.itwas=true; }
                const stopOnce  = f => { if (rna.once && API.itwas) API.stop() }
                const API = {
                    data:   { dna:rna },
                    state:    false,
                    itwas:    false,
                    setState: setState,
                    runFYes:  rna.fy,
                    runFNot:  rna.fn,
                    forceYes: hasInsect,
                    forceNot: notInsect,
                    stopOnce: stopOnce,
                    stop:     offInsect,
                    run:      runInsect
                }
                API.run()
            }
            insect00({
                trigger: '.insect2c',
                target:  '#insect1',
                //margin:  '0% 0% 0% 0%',
                //once: false,
                //marker: 'on-screen'
                //fy: f=>console.log('yes'),
                //fn: f=>console.log('no'),
                //elTrigger: document.querySelector('.insect2c'),
                //elTarget:  document.querySelector('#insect1')
            })
        </script>
    </article>

    <!-- ----------------------------------------- SVG Under DIV -->

    <article class="journal-grid chapter">
        <header>
            <h2>SVG Under DIV</h2>
            <p>2019.11.7</p>
        </header>
        <style>
            .divik {
                width: 20rem;
                height: 4rem;
                outline:  2px solid lightskyblue;
                position: relative;
                z-index:  0;
            }
            .divik + .divik { margin-top: 1rem; }
        </style>
        <section>
            <div class="divik"></div>
            <div class="divik"></div>
        </section>
    </article>

    <!-- ----------------------------------------- Web Components -->

    <article class="journal-grid chapter">
        <header>
            <h2>Friendly Web Components</h2>
            <p>
                Source: Atomico<br>
                https://github.com/atomicojs/atomico<br>
                2019.6.18
            </p>
        </header>
        <section class="box color-box">

            <!--declare web-component-->
            <web-component message="Hello!" counter="1">
                <p>Markup Content</p>
            </web-component>

            <!--create web-component-->
            <script type="module">
                import { customElement, useState } from "https://unpkg.com/atomico@0.8.6";
                import html from "https://unpkg.com/atomico@0.8.6/html.js";

                function WebComponent({ message, counter }) {
                    return html`
                        <host shadowDom>
                            <style>
                                :host { display: block; }
                                p { margin-left: 1rem; }
                            </stile>
                            <h2>${message}</h2>
                            <p>Attribute value: ${counter+1}</p>
                            <slot />
                        </host>
                    `;
                }
                WebComponent.observables = {
                    message: String,
                    counter: Number
                };

                customElement("web-component", WebComponent);

                let wc = document.querySelector("web-component");
                wc.message = "Attribute Message";
            </script>

        </section>
    </article>

    <!-- ----------------------------------------- Scroll To Property -->

    <article class="journal-grid chapter">
        <header>
            <h2>Scroll To Property (Wayway)</h2>
        </header>
        <style>
            .happy { color:firebrick }
            .make-me-happy { background-color:wheat }
        </style>
        <section class="layer">
            <div class="make-me-wayway padding is-centered font-size" style="--font-size:10px;">Font size from 10px to 60px</div>
        </section>
        <script>
            app.wayway({
                elem: document.querySelector('.make-me-wayway'),
                from: 'top-bottom',
                to:   'top-top',
                props: { '--font-size': {from:'10px',to:'60px'} },
                direct: true
            })
        </script>
        <code><pre>
            app.wayway({
                elem: document.querySelector('.make-me-wayway'),
                from: 'top-bottom',
                to:   'top-top',
                props: { '--font-size': {from:'10px',to:'60px'} },
                direct: true
            })
        </pre></code>
    </article>

    <!-- ----------------------------------------- Lazy Loading -->

    <article class="journal-grid chapter">
        <header>
            <h2>Lazy Loader</h2>
            <p>With Intersection Observer</p>
        </header>
        <style>
            [data-src]:not([src]) {
                min-width:        100%;
                min-height:       400px;
                background-color: pink;
            }
        </style>
        <section class="screen back-color-accent">
            <figure><img data-src="https://source.unsplash.com/random/800x200" width="800" height="200" alt="" class="zzz"></figure>
            <figure><img data-src="https://source.unsplash.com/random/800x800" width="800" height="200" alt="" class="zzz"></figure>
        </section>
        <section class="screen">
            <figure><img data-src="https://source.unsplash.com/random/800x400" alt="" class="zzz"></figure>
            <figure><img data-src="https://source.unsplash.com/random/800x600" alt="" class="zzz"></figure>
        </section>
        <section class="screen back-color-accent">
            <figure><img data-src="https://source.unsplash.com/random/600x300" alt="" class="zzz"></figure>
            <figure><img data-src="https://source.unsplash.com/random/200x400" alt="" class="zzz"></figure>
        </section>
        <section class="screen">
            <figure><img data-src="https://source.unsplash.com/random/800x100" alt="" class="zzz"></figure>
            <figure><img data-src="https://source.unsplash.com/random/800x300" alt="" class="zzz"></figure>
        </section>
    </article>

    <!-- ----------------------------------------- Class Change -->

    <article class="journal-grid chapter">
        <header>
            <h2>Change CSS Class</h2>
        </header>
        <style>
            .happy { color:firebrick }
            .make-me-happy { background-color:wheat }
        </style>
        <div class="make-me-happy">DIV.make-me-happy → DIV.happy (red color)</div>
        <script>
            app.mutate({
                for:         'make-me-happy',
                removeClass: 'make-me-happy',
                addClass:    'happy'
            })
        </script>
        <code><pre>
            app.mutate({
                for:         'make-me-happy',
                removeClass: 'make-me-happy',
                addClass:    'happy'
            })
        </pre></code>
    </article>




<!-- ========================================= PAGE CUSTOM -->



</body>
</html>
